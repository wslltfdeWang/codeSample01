<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.foreveross.vds.service.fms.mapper.FmsCarCategoryReleationMapper">
  <resultMap id="fmsCarCategoryReleationMap" type="com.foreveross.vds.vo.fms.FmsCarCategoryReleation">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="CAR_CATEGORY_RELEATION_ID" jdbcType="DECIMAL" property="carCategoryReleationId" />
    <result column="CAR_CATEGORY_ID" jdbcType="DECIMAL" property="carCategoryId" />
    <result column="CAR_SERIES_ID" jdbcType="DECIMAL" property="carSeriesId" />
    <result column="ENABLED_FLAG" jdbcType="VARCHAR" property="enabledFlag" />
    <result column="START_DATE" jdbcType="TIMESTAMP" property="startDate" />
    <result column="END_DATE" jdbcType="TIMESTAMP" property="endDate" />
    <result column="CREATED_BY" jdbcType="DECIMAL" property="createdBy" />
    <result column="CREATION_DATE" jdbcType="TIMESTAMP" property="creationDate" />
    <result column="LAST_UPDATED_BY" jdbcType="DECIMAL" property="lastUpdatedBy" />
    <result column="LAST_UPDATE_DATE" jdbcType="TIMESTAMP" property="lastUpdateDate" />
    <result column="LAST_UPDATE_LOGIN" jdbcType="VARCHAR" property="lastUpdateLogin" />
    <result column="ATTRIBUTE1" jdbcType="VARCHAR" property="attribute1" />
    <result column="ATTRIBUTE2" jdbcType="VARCHAR" property="attribute2" />
    <result column="ATTRIBUTE3" jdbcType="VARCHAR" property="attribute3" />
    <result column="ATTRIBUTE4" jdbcType="VARCHAR" property="attribute4" />
    <result column="ATTRIBUTE5" jdbcType="VARCHAR" property="attribute5" />
    <result column="ATTRIBUTE6" jdbcType="VARCHAR" property="attribute6" />
    <result column="ATTRIBUTE7" jdbcType="VARCHAR" property="attribute7" />
    <result column="ATTRIBUTE8" jdbcType="VARCHAR" property="attribute8" />
    <result column="ATTRIBUTE9" jdbcType="VARCHAR" property="attribute9" />
    <result column="ATTRIBUTE10" jdbcType="VARCHAR" property="attribute10" />
    <result column="VEHICLE_CODE" jdbcType="VARCHAR" property="vehicleCode" />
    <result column="ORG_ID" jdbcType="DECIMAL" property="orgId" />
  </resultMap>
  <resultMap id="invCarSeriesMap" type="com.foreveross.vds.vo.inv.InvCarSeries">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="CAR_SERIES_ID" jdbcType="DECIMAL" property="carSeriesId" />
    <result column="CAR_SERIES_CODE" jdbcType="VARCHAR" property="carSeriesCode" />
    <result column="CAR_SERIES_NAME" jdbcType="VARCHAR" property="carSeriesName" />
    <result column="ENABLE_FLAG" jdbcType="VARCHAR" property="enableFlag" />
    <result column="START_DATE" jdbcType="TIMESTAMP" property="startDate" />
    <result column="END_DATE" jdbcType="TIMESTAMP" property="endDate" />
    <result column="CREATED_BY" jdbcType="DECIMAL" property="createdBy" />
    <result column="CREATION_DATE" jdbcType="TIMESTAMP" property="creationDate" />
    <result column="LAST_UPDATED_BY" jdbcType="DECIMAL" property="lastUpdatedBy" />
    <result column="LAST_UPDATE_DATE" jdbcType="TIMESTAMP" property="lastUpdateDate" />
    <result column="LAST_UPDATE_LOGIN" jdbcType="VARCHAR" property="lastUpdateLogin" />
    <result column="ATTRIBUTE1" jdbcType="VARCHAR" property="attribute1" />
    <result column="ATTRIBUTE2" jdbcType="VARCHAR" property="attribute2" />
    <result column="ATTRIBUTE3" jdbcType="VARCHAR" property="attribute3" />
    <result column="ATTRIBUTE4" jdbcType="VARCHAR" property="attribute4" />
    <result column="ATTRIBUTE5" jdbcType="VARCHAR" property="attribute5" />
    <result column="ATTRIBUTE6" jdbcType="VARCHAR" property="attribute6" />
    <result column="ATTRIBUTE7" jdbcType="VARCHAR" property="attribute7" />
    <result column="ATTRIBUTE8" jdbcType="VARCHAR" property="attribute8" />
    <result column="ATTRIBUTE9" jdbcType="VARCHAR" property="attribute9" />
    <result column="ATTRIBUTE10" jdbcType="VARCHAR" property="attribute10" />
    <result column="CAR_CATEGORY_RELEATION_ID" jdbcType="VARCHAR" property="carCategorReleationId" />
    <result column="ORG_ID" jdbcType="DECIMAL" property="orgId" />
    <result column="VEHICLE_CODE" jdbcType="VARCHAR" property="vehicleCode" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from FMS.FMS_CAR_CATEGORY_RELEATION
    where CAR_CATEGORY_RELEATION_ID = #{carCategoryReleationId,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" parameterType="com.foreveross.vds.vo.fms.FmsCarCategoryReleation">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into FMS.FMS_CAR_CATEGORY_RELEATION (CAR_CATEGORY_RELEATION_ID, CAR_CATEGORY_ID,
    CAR_SERIES_ID, ENABLED_FLAG, START_DATE,
    END_DATE, CREATED_BY, CREATION_DATE,
    LAST_UPDATED_BY, LAST_UPDATE_DATE, LAST_UPDATE_LOGIN,
    ATTRIBUTE1, ATTRIBUTE2, ATTRIBUTE3,
    ATTRIBUTE4, ATTRIBUTE5, ATTRIBUTE6,
    ATTRIBUTE7, ATTRIBUTE8, ATTRIBUTE9,
    ATTRIBUTE10,VEHICLE_CODE)
    values (FMS_CAR_CATEGORY_RELEATION_S.nextval, #{carCategoryId,jdbcType=DECIMAL},
    #{carSeriesId,jdbcType=DECIMAL}, #{enabledFlag,jdbcType=VARCHAR}, #{startDate,jdbcType=TIMESTAMP},
    #{endDate,jdbcType=TIMESTAMP}, #{createdBy,jdbcType=DECIMAL}, #{creationDate,jdbcType=TIMESTAMP},
    #{lastUpdatedBy,jdbcType=DECIMAL}, #{lastUpdateDate,jdbcType=TIMESTAMP}, #{lastUpdateLogin,jdbcType=VARCHAR},
    #{attribute1,jdbcType=VARCHAR}, #{attribute2,jdbcType=VARCHAR}, #{attribute3,jdbcType=VARCHAR},
    #{attribute4,jdbcType=VARCHAR}, #{attribute5,jdbcType=VARCHAR}, #{attribute6,jdbcType=VARCHAR},
    #{attribute7,jdbcType=VARCHAR}, #{attribute8,jdbcType=VARCHAR}, #{attribute9,jdbcType=VARCHAR},
    #{attribute10,jdbcType=VARCHAR},#{vehicleCode,jdbcType=VARCHAR})
  </insert>

  <update id="updateByPrimaryKey" parameterType="com.foreveross.vds.vo.fms.FmsCarCategoryReleation">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update FMS.FMS_CAR_CATEGORY_RELEATION
    set CAR_CATEGORY_ID = #{carCategoryId,jdbcType=DECIMAL},
    CAR_SERIES_ID = #{carSeriesId,jdbcType=DECIMAL},
    ENABLED_FLAG = #{enabledFlag,jdbcType=VARCHAR},
    START_DATE = #{startDate,jdbcType=TIMESTAMP},
    END_DATE = #{endDate,jdbcType=TIMESTAMP},
    CREATED_BY = #{createdBy,jdbcType=DECIMAL},
    CREATION_DATE = #{creationDate,jdbcType=TIMESTAMP},
    LAST_UPDATED_BY = #{lastUpdatedBy,jdbcType=DECIMAL},
    LAST_UPDATE_DATE = #{lastUpdateDate,jdbcType=TIMESTAMP},
    LAST_UPDATE_LOGIN = #{lastUpdateLogin,jdbcType=VARCHAR},
    ATTRIBUTE1 = #{attribute1,jdbcType=VARCHAR},
    ATTRIBUTE2 = #{attribute2,jdbcType=VARCHAR},
    ATTRIBUTE3 = #{attribute3,jdbcType=VARCHAR},
    ATTRIBUTE4 = #{attribute4,jdbcType=VARCHAR},
    ATTRIBUTE5 = #{attribute5,jdbcType=VARCHAR},
    ATTRIBUTE6 = #{attribute6,jdbcType=VARCHAR},
    ATTRIBUTE7 = #{attribute7,jdbcType=VARCHAR},
    ATTRIBUTE8 = #{attribute8,jdbcType=VARCHAR},
    ATTRIBUTE9 = #{attribute9,jdbcType=VARCHAR},
    ATTRIBUTE10 = #{attribute10,jdbcType=VARCHAR}
    where CAR_CATEGORY_RELEATION_ID = #{carCategoryReleationId,jdbcType=DECIMAL}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="fmsCarCategoryReleationMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select CAR_CATEGORY_RELEATION_ID, CAR_CATEGORY_ID, CAR_SERIES_ID, ENABLED_FLAG, START_DATE,
    END_DATE, CREATED_BY, CREATION_DATE, LAST_UPDATED_BY, LAST_UPDATE_DATE, LAST_UPDATE_LOGIN,
    ATTRIBUTE1, ATTRIBUTE2, ATTRIBUTE3, ATTRIBUTE4, ATTRIBUTE5, ATTRIBUTE6, ATTRIBUTE7,
    ATTRIBUTE8, ATTRIBUTE9, ATTRIBUTE10
    from FMS.FMS_CAR_CATEGORY_RELEATION
    where CAR_CATEGORY_RELEATION_ID = #{carCategoryReleationId,jdbcType=DECIMAL}
  </select>
  <select id="selectAll" resultMap="fmsCarCategoryReleationMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select CAR_CATEGORY_RELEATION_ID, CAR_CATEGORY_ID, CAR_SERIES_ID, ENABLED_FLAG, START_DATE,
    END_DATE, CREATED_BY, CREATION_DATE, LAST_UPDATED_BY, LAST_UPDATE_DATE, LAST_UPDATE_LOGIN,
    ATTRIBUTE1, ATTRIBUTE2, ATTRIBUTE3, ATTRIBUTE4, ATTRIBUTE5, ATTRIBUTE6, ATTRIBUTE7,
    ATTRIBUTE8, ATTRIBUTE9, ATTRIBUTE10
    from FMS.FMS_CAR_CATEGORY_RELEATION
  </select>

  <select id="selectRelationByWhereClause" resultMap="fmsCarCategoryReleationMap">
    select t1.CAR_CATEGORY_RELEATION_ID, t1.CAR_CATEGORY_ID, t1.CAR_SERIES_ID, t1.ENABLED_FLAG, t1.START_DATE,
    t1.END_DATE, t1.CREATED_BY, t1.CREATION_DATE, t1.LAST_UPDATED_BY, t1.LAST_UPDATE_DATE, t1.LAST_UPDATE_LOGIN,
    t1.ATTRIBUTE1, t1.ATTRIBUTE2, t1.ATTRIBUTE3, t1.ATTRIBUTE4, t1.ATTRIBUTE5, t1.ATTRIBUTE6, t1.ATTRIBUTE7,
    t1.ATTRIBUTE8, t1.ATTRIBUTE9, t1.ATTRIBUTE10, t1.VEHICLE_CODE,t2.ORG_ID,
    t2.CAR_CATEGORY_CODE carCategoryCode,
    t2.CAR_CATEGORY_NAME carCategoryName,
    t3.CAR_SERIES_CODE carSeriesCode,
    t3.CAR_SERIES_NAME carSeriesName
    from FMS_CAR_CATEGORY_RELEATION t1
    JOIN FMS_CAR_CATEGORY t2 on t1.CAR_CATEGORY_ID = t2.CAR_CATEGORY_ID
    JOIN INV_CAR_SERIES t3 on t1.CAR_SERIES_ID = t3.CAR_SERIES_ID
    where 1=1
    <if test="carCategoryCode != null and carCategoryCode != ''">
      AND t2.CAR_CATEGORY_CODE like '%${carCategoryCode}%'
    </if>
    <if test="carCategoryName != null and carCategoryName != ''">
      AND t2.CAR_CATEGORY_NAME like '%${carCategoryName}%'
    </if>
    <if test="carSeriesCode != null and carSeriesCode != ''">
      AND t3.CAR_SERIES_CODE like '%${carSeriesCode}%'
    </if>
    <if test="carSeriesName != null and carSeriesName != ''">
      AND t3.CAR_SERIES_NAME like '%${carSeriesName}%'
    </if>
    <if test="vehicleCode != null and vehicleCode != ''">
      AND t1.VEHICLE_CODE like '%${vehicleCode}%'
    </if>
  </select>
  
    <select id="selectRelationByWhereClauseNotSeries" resultMap="fmsCarCategoryReleationMap">
    select t1.CAR_CATEGORY_RELEATION_ID, t1.CAR_CATEGORY_ID, t1.CAR_SERIES_ID, t1.ENABLED_FLAG, t1.START_DATE,
    t1.END_DATE, t1.CREATED_BY, t1.CREATION_DATE, t1.LAST_UPDATED_BY, t1.LAST_UPDATE_DATE, t1.LAST_UPDATE_LOGIN,
    t1.ATTRIBUTE1, t1.ATTRIBUTE2, t1.ATTRIBUTE3, t1.ATTRIBUTE4, t1.ATTRIBUTE5, t1.ATTRIBUTE6, t1.ATTRIBUTE7,
    t1.ATTRIBUTE8, t1.ATTRIBUTE9, t1.ATTRIBUTE10, t1.VEHICLE_CODE,t2.ORG_ID,
    t2.CAR_CATEGORY_CODE carCategoryCode,
    t2.CAR_CATEGORY_NAME carCategoryName,
    t3.CAR_SERIES_CODE carSeriesCode,
    t3.CAR_SERIES_NAME carSeriesName
    from FMS_CAR_CATEGORY_RELEATION t1
    JOIN FMS_CAR_CATEGORY t2 on t1.CAR_CATEGORY_ID = t2.CAR_CATEGORY_ID
    left JOIN INV_CAR_SERIES t3 on t1.CAR_SERIES_ID = t3.CAR_SERIES_ID
    where 1=1 
    <if test="carCategoryCode != null and carCategoryCode != ''">
      AND t2.CAR_CATEGORY_CODE like '%${carCategoryCode}%'
    </if>
    <if test="carCategoryName != null and carCategoryName != ''">
      AND t2.CAR_CATEGORY_NAME like '%${carCategoryName}%'
    </if>
    <if test="carSeriesCode != null and carSeriesCode != ''">
      AND t3.CAR_SERIES_CODE like '%${carSeriesCode}%'
    </if>
    <if test="carSeriesName != null and carSeriesName != ''">
      AND t3.CAR_SERIES_NAME like '%${carSeriesName}%'
    </if>
    <if test="vehicleCode != null and vehicleCode != ''">
      AND t1.VEHICLE_CODE like '%${vehicleCode}%'
    </if>
  </select>
  
  <select id="selectRelationByWhereClauseNotLike" resultMap="fmsCarCategoryReleationMap">
    select t1.CAR_CATEGORY_RELEATION_ID, t1.CAR_CATEGORY_ID, t1.CAR_SERIES_ID, t1.ENABLED_FLAG, t1.START_DATE,
    t1.END_DATE, t1.CREATED_BY, t1.CREATION_DATE, t1.LAST_UPDATED_BY, t1.LAST_UPDATE_DATE, t1.LAST_UPDATE_LOGIN,
    t1.ATTRIBUTE1, t1.ATTRIBUTE2, t1.ATTRIBUTE3, t1.ATTRIBUTE4, t1.ATTRIBUTE5, t1.ATTRIBUTE6, t1.ATTRIBUTE7,
    t1.ATTRIBUTE8, t1.ATTRIBUTE9, t1.ATTRIBUTE10, t1.VEHICLE_CODE,t2.ORG_ID,
    t2.CAR_CATEGORY_CODE carCategoryCode,
    t2.CAR_CATEGORY_NAME carCategoryName
    from FMS_CAR_CATEGORY_RELEATION t1
    JOIN FMS_CAR_CATEGORY t2 on t1.CAR_CATEGORY_ID = t2.CAR_CATEGORY_ID
    where 1=1
    <if test="carCategoryCode != null and carCategoryCode != ''">
      AND t2.CAR_CATEGORY_CODE = #{carCategoryCode}
    </if>
      AND t2.CAR_CATEGORY_NAME = #{carCategoryName}
      AND t1.VEHICLE_CODE = #{vehicleCode}
  </select>

  <select id="leftQuery" resultMap="invCarSeriesMap">
      select *
      from INV_CAR_SERIES t1
      where 1=1
      <if test="carCategoryId != null and carCategoryId != ''">
        and t1.CAR_SERIES_ID not in
        (
        select t2.CAR_SERIES_ID from FMS_CAR_CATEGORY_RELEATION t2
        )
      </if>
      <if test="carSeriesCode != null and carSeriesCode != ''">
        AND t1.CAR_SERIES_CODE like '%${carSeriesCode}%'
      </if>


  </select>

  <select id="rightQuery" resultMap="invCarSeriesMap">
    select t2.*,t1.CAR_CATEGORY_RELEATION_ID
    from FMS_CAR_CATEGORY_RELEATION t1
    join INV_CAR_SERIES t2 on t1.CAR_SERIES_ID = t2.CAR_SERIES_ID
    where 1=1
    <if test="_parameter != null">
      and t1.CAR_CATEGORY_ID = #{carCategoryId}
    </if>
  </select>

  <select id="selectCarSeriesBy" parameterType="com.foreveross.vds.vo.inv.InvCarSeries" resultType="com.foreveross.vds.vo.inv.InvCarSeries">
    select
    *
    from INV.INV_CAR_SERIES
    <where>
      <if test="carSeriesCode != null and carSeriesCode != ''">
        AND CAR_SERIES_CODE = #{carSeriesCode}
      </if>
      <if test="carSeriesName != null and carSeriesName != ''">
        AND CAR_SERIES_NAME = #{carSeriesName}
      </if>
    </where>
  </select>
  
    <select id="selectCarSeriesById" parameterType="com.foreveross.vds.vo.inv.InvCarSeries" resultType="com.foreveross.vds.vo.inv.InvCarSeries">
    select
    *
    from INV.INV_CAR_SERIES
    <where>
      <if test="carSeriesCode != null and carSeriesCode != ''">
        AND CAR_SERIES_CODE = #{carSeriesCode}
      </if>
      <if test="carSeriesName != null and carSeriesName != ''">
        AND CAR_SERIES_NAME = #{carSeriesName}
      </if>
        And CAR_SERIES_ID = #{carSeriesId}
    </where>
  </select>

	<select id="selectCarSeriesByVehicleCode"
		parameterType="com.foreveross.vds.vo.inv.InvCarSeries"
		resultType="com.foreveross.vds.vo.inv.InvCarSeries">
		select * from( select r1.vehicle_code,r1.car_series_id,
		r2.operating_unit
		from INV_MATERIAL_INFO r1, INV_ORGANIZATION_DEFINITIONS r2
		where r1.organization_id = r2.organization_id
		and r1.car_series_id is not null
		and r2.operating_unit is not null
		group by r1.car_series_id, r1.vehicle_code, r2.operating_unit)
		<where>
				vehicle_code = #{vehicleCode}
			AND operating_unit =#{orgId}
		</where>
	</select>
</mapper>